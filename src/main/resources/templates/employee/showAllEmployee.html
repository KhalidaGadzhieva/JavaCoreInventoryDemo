<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Team</title>
    <link rel="stylesheet" th:href="@{/employeeStyles/showAllEmployee.css}">
    <link rel="stylesheet" th:href="@{/employeeStyles/modalForDelete.css}">
</head>
<body>
<div class="container">
    <button class="home-button" onclick="window.location.href='/user/home'">← BACK TO HOME</button>
    <button class="add-new-btn" onclick="window.location.href='/employee/new'">+ CREATE NEW EMPLOYEE</button>

    <h1>TEAM</h1>


    <div class="employee-list">
        <div th:each="employee : ${employeeList}" class="employee-card">
            <div class="employee-info">
                <h2 th:text="${employee.firstName + ' ' + employee.lastName}">FullName</h2>
                <p><strong>Position:</strong> <span th:text="${employee.position}">Position</span></p>
                <p><strong>Birthdate:</strong> <span th:text="${employee.birthDate}">01.01.1990</span></p>
                <p><strong>Phone number:</strong> <span th:text="${employee.phoneNumber}">+994</span></p>
                <p><strong>Email:</strong> <span th:text="${employee.email}">email@example.com</span></p>
                <p><strong>Hire date:</strong> <span th:text="${employee.hireDate}">2023-01-01</span></p>
                <p><strong>Hire order №:</strong> <span th:text="${employee.hireOrderNumber}">№001</span></p>
            </div>
                <div class="actions">
                    <a th:href="@{/employee/edit/{id}(id=${employee.id})}" class="edit-btn">EDIT</a>
                    <a th:href="@{/employee/get/{id}(id=${employee.id})}" class="edit-btn">MORE INFO</a>
<!--                    <button class="edit-btn" th:attr="onclick=|openModal(${employee.id})|">DELETE</button>-->
                    <a href="#" th:attr="onclick=|openModal(${employee.id})|" class="edit-btn">DELETE</a>

                </div>


        </div>
    </div>
</div>

<div id="deleteModal" class="modal">
    <div class="modal-content">
        <p>Are you sure you want to delete this Employee?</p>
        <form id="deleteForm" method="post">
            <input type="hidden" name="_method" value="delete"/>
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <button type="submit" class="confirm-btn">Yes</button>
            <button type="button" class="cancel-btn" onclick="closeModal()">No</button>
        </form>
    </div>
</div>
<script>
    // Показывает модальное окно и вставляет ID в action формы
    function openModal(employeeId) {
        console.log('openModal called with id:', employeeId);
        const modal = document.getElementById('deleteModal');
        const form = document.getElementById('deleteForm');
        form.setAttribute('action', '/employee/delete/' + employeeId);
        modal.style.display = 'flex';
    }

    // Закрывает модалку
    function closeModal() {
        document.getElementById('deleteModal').style.display = 'none';
    }

    // Закрывает по клику вне окна
    window.onclick = function(event) {
        const modal = document.getElementById('deleteModal');
        if (event.target === modal) {
            modal.style.display = 'none';
        }
    }
</script>

</body>
</html>
